# sops encrypt secrets.tf
encrypt $SOPS_AGE_KEY_FILE:
    sops --encrypt \
    --age $(cat $SOPS_AGE_KEY_FILE | \
      grep -oP "public key: \K(.*)") \
    --in-place ./secrets.tf

# sops decrypt secrets.tf
decrypt $SOPS_AGE_KEY_FILE:
    sops --decrypt \
    --age $(cat $SOPS_AGE_KEY_FILE | \
      grep -oP "public key: \K(.*)") \
    --in-place ./secrets.tf